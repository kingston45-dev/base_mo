# base_mo
Система управления статистической информацией по медицинским организациям
# Название проекта

**Система управления медицинскими организациями и статистической информацией**

## Описание проекта

Данный проект представляет собой веб-приложение, разработанное на Flask, которое позволяет пользователям управлять и получать информацию о медицинских организациях и статистических данных. Система подключается к базе данных PostgreSQL и предоставляет функционал для работы с данными, включая их визуализацию, экспорт в Excel, а также выполнение CRUD-операций.

## Основные функции

- **Управление медицинскими организациями**:
  - Добавление, редактирование, удаление и просмотр информации о медицинских организациях.
  - Экспорт данных о медицинских организациях в формате Excel.

- **Управление статистической информацией**:
  - Добавление, редактирование, удаление и просмотр статистической информации о регионах.
  - Экспорт статистических данных в формате Excel.

- **Статистика по картам**:
  - Просмотр статистики по картам, закодированным в формате Base64.

- **Интеграция с базой данных**:
  - Широкие возможности работы с PostgreSQL для хранения и извлечения данных.

## Используемые технологии

- **Backend**:
  - Python 3.10
  - Flask

- **База данных**:
  - PostgreSQL

- **Frontend**:
  - HTML/CSS (с использованием шаблонов Flask)

- **Библиотеки**:
  - psycopg2 для подключения к базе данных
  - xlwt для генерации файлов Excel

## Установка

1. Склонируйте репозиторий:

   ```bash
   git clone https://github.com/kingston45-dev/base_mo.git
   ```

2. Перейдите в директорию проекта:

   ```bash
   cd base_mo
   ```

3. Настройте базу данных:
   - Установите PostgreSQL.
   - Создайте базу данных с необходимой структурой (см. раздел "Структура базы данных").
   - Настройте файл конфигурации `.env` для хранения учетных данных:

     ```env
     DB_HOST=localhost
     DB_NAME=base1
     DB_USER=your_username
     DB_PASS=your_password
     ```

   - Убедитесь, что библиотека `python-dotenv` установлена:

     ```bash
     pip install python-dotenv
     ```

4. Установите необходимые библиотеки Python:

   ```bash
   pip install -r requirements.txt
   ```

5. Запустите Flask-приложение:

   ```bash
   python app.py
   ```

6. Откройте приложение в браузере по адресу `http://127.0.0.1:5000/`.

## Структура базы данных

Приложение использует базу данных PostgreSQL для хранения информации о медицинских организациях и статистических данных.

### Таблицы базы данных

1. **mo** — информация о медицинских организациях:
   - `id_subject` (INTEGER): Код субъекта РФ.
   - `mo_name` (TEXT): Название медицинской организации.
   - `anchoring` (CHAR): Признак якорности медицинской организации (`+` или `-`).
   - `year` (INTEGER): Год, к которому относится запись.

2. **stat_info** — статистическая информация по регионам:
   - `id_subject` (INTEGER): Код субъекта РФ.
   - `subject_rf` (TEXT): Название субъекта РФ.
   - `year` (INTEGER): Год.
   - `population_all` (INTEGER): Общее население.
   - `population_adult` (INTEGER): Взрослое население.
   - `population_city` (INTEGER): Городское население.
   - `population_country` (INTEGER): Сельское население.
   - `max_distance` (FLOAT): Максимальная удаленность до ближайшей медицинской организации.

3. **maps_stat** — информация для отображения карт:
   - `id_subject` (INTEGER): Код субъекта РФ.
   - `map_stat` (BYTEA): Закодированное изображение карты в формате Base64.

### Пример SQL-скрипта

```sql
-- Таблица для медицинских организаций
CREATE TABLE mo (
    id_subject INTEGER PRIMARY KEY,
    mo_name TEXT NOT NULL,
    anchoring CHAR(1) NOT NULL,
    year INTEGER NOT NULL
);

-- Таблица для статистической информации
CREATE TABLE stat_info (
    id_subject INTEGER,
    subject_rf TEXT NOT NULL,
    year INTEGER,
    population_all INTEGER,
    population_adult INTEGER,
    population_city INTEGER,
    population_country INTEGER,
    max_distance FLOAT,
    PRIMARY KEY (id_subject, year)
);

-- Таблица для данных по картам
CREATE TABLE maps_stat (
    id_subject INTEGER PRIMARY KEY,
    map_stat BYTEA
);
```

### Пример данных

```sql
-- Таблица mo
INSERT INTO mo (id_subject, mo_name, anchoring, year) VALUES
(1, 'Городская больница №1', '+', 2023),
(2, 'Поликлиника №3', '-', 2023);

-- Таблица stat_info
INSERT INTO stat_info (id_subject, subject_rf, year, population_all, population_adult, population_city, population_country, max_distance) VALUES
(1, 'Московская область', 2023, 7500000, 5200000, 6300000, 1200000, 50.5);

-- Таблица maps_stat
INSERT INTO maps_stat (id_subject, map_stat) VALUES
(1, DECODE('...', 'base64'));
```

## Структура папок

```
.
├── app.py                 # Flask-приложение
├── templates/             # HTML-шаблоны
│   ├── index.html         # Главная страница
│   ├── edit.html          # Шаблон редактирования МО
│   ├── stat.html          # Шаблон для статистической информации
│   └── ...
├── static/                # Статические файлы (CSS, JS, изображения)
├── requirements.txt       # Зависимости Python
└── README.md              # Документация проекта
```

## Использование

### Управление медицинскими организациями
- Перейдите на главную страницу для просмотра списка медицинских организаций.
- Используйте кнопку "Добавить" для создания новой записи.
- Редактируйте или удаляйте существующие записи по необходимости.

### Работа со статистической информацией
- Просматривайте данные статистики в соответствующем разделе.
- Обновляйте или удаляйте записи для определенных лет и регионов.

### Экспорт данных
- Нажмите на кнопку экспорта для скачивания данных в формате Excel.
